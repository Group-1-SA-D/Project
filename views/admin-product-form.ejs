<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/layout_head') %>
    <title><%= title %></title>
    <style>
        .admin-form-container {
            margin-top: 2rem;
            max-width: 800px;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .available-images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .image-option {
            width: 100px;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .image-option:hover, .image-option.selected {
            border-color: #dc3545;
        }
    </style>
</head>
<body>
    <%- include('partials/navbar') %>
    <div class="container admin-form-container">
        <h1 class="mb-4"><%= title %></h1>
        
        <% if (error) { %>
            <div class="alert alert-danger"><%= error %></div>
        <% } %>

        <form method="POST" action="<%= product ? '/admin/products/edit/' + product.id : '/admin/products/add' %>">
            <div class="form-group">
                <label class="form-label">Product Name</label>
                <input type="text" class="form-control" name="name" value="<%= product ? product.name : '' %>" required>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Price ($)</label>
                        <input type="number" step="0.01" class="form-control" name="price" value="<%= product ? product.price : '' %>" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-select" name="category" required>
                            <option value="Apparel" <%= product && product.category === 'Apparel' ? 'selected' : '' %>>Apparel</option>
                            <option value="Merchandise" <%= product && product.category === 'Merchandise' ? 'selected' : '' %>>Merchandise</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-control" name="description" rows="4"><%= product ? product.description : '' %></textarea>
            </div>

            <div class="form-group">
                <label class="form-label">Image Filename</label>
                <input type="text" class="form-control" id="imageInput" name="image" value="<%= product ? product.image : '' %>" required>
                <small class="text-muted">Available images:</small>
                <div class="available-images">
                    <% ['tshirt.png', 'Hoodie.png', 'cap.png', 'cards.png', 'Mug.png', 'Socks.png'].forEach(img => { %>
                        <img src="/media/img/<%= img %>" class="image-option" 
                             onclick="document.getElementById('imageInput').value = '<%= img %>'; 
                                      document.querySelectorAll('.image-option').forEach(el => el.classList.remove('selected'));
                                      this.classList.add('selected')" 
                             style="height: 80px; object-fit: contain;">
                    <% }) %>
                </div>
            </div>

            <div class="d-flex gap-3 mt-4">
                <button type="submit" class="btn btn-primary">Save Product</button>
                <a href="/admin/products" class="btn btn-outline-secondary">Cancel</a>
            </div>
        </form>
    </div>
    <%- include('partials/layout_footer') %>
</body>
</html>